/* =================================================================== */
/* assets/css/main.css - Master Import File */
/* =================================================================== */

@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css');

/* Critical CSS - Foundation Layer (loads first) */
@import './01-foundation/_colors.css';
@import './01-foundation/_variables.css';
@import './01-foundation/_reset.css';
@import './01-foundation/_typography.css';
@import './01-foundation/_accessibility.css';

/* Layout System */
@import './02-layout/_grid.css';
@import './02-layout/_containers.css';
@import './02-layout/_theme-provider.css';
@import './07-utilities/_spacing.css';
@import './07-utilities/_positioning.css';

/* Component Library */
@import './03-components/_buttons.css';
@import './03-components/_cards.css';
@import './03-components/_chips.css';
@import './03-components/_alerts.css';
@import './03-components/_forms.css';
@import './03-components/_navigation.css';
@import './03-components/_modals.css';
@import './03-components/_safe-components.css';
@import './03-components/_device-verification.css';
@import './03-components/_upload.css';

/* Dashboard Panels */
@import './04-panels/_panel-base.css';
@import './04-panels/_map-panel.css';
@import './04-panels/_alert-panel.css';
@import './04-panels/_signal-panel.css';
@import './04-panels/_bottom-panel.css';
@import './04-panels/_navbar.css';

/* Page-Specific Styles */
@import './05-pages/_graphs.css';
@import './05-pages/_settings.css';
@import './05-pages/_analytics.css';
@import './05-pages/_file_upload.css';

/* Theme System */
@import './06-themes/_themes.css';

/* Utility Classes */
@import './07-utilities/_display.css';
@import './07-utilities/_flexbox.css';
@import './07-utilities/_animations.css';
@import './07-utilities/_transitions.css';
@import './07-utilities/_colors.css';
@import './07-utilities/_sizing.css';
@import './07-utilities/_text.css';

.nav-icon { margin-right: 0.5rem; }
.navbar-brand-link { text-decoration: none; }
.navbar-brand-link:hover { text-decoration: none; }


/* ICON VISIBILITY FIXES */
.nav-icon,
.nav-icon--image,
.nav-icon--fallback {
  width: 20px !important;
  height: 20px !important;
  margin-right: 0.75rem !important;
}

.nav-icon--image {
  max-width: 20px;
  max-height: 20px;
  opacity: 1 !important;
  filter: brightness(1.2) contrast(1.1);
}

.nav-icon--fallback {
  font-size: 16px !important;
  line-height: 20px;
  color: #212529 !important;
  font-weight: 600;
}

.nav-link-stable {
  color: #212529 !important;
  font-weight: 500;
}

/* FORCE ICON FIXES WITH MAXIMUM SPECIFICITY */
.navbar-stable .nav-icon,
.navbar-stable .nav-icon--image,
.navbar-stable .nav-icon--fallback,
nav .nav-icon,
nav .nav-icon--image {
  width: 24px !important;
  height: 24px !important;
  margin-right: 0.75rem !important;
  opacity: 1 !important;
  filter: brightness(1.3) contrast(1.2) !important;
}

.navbar-stable .nav-link-stable,
nav .nav-link-stable {
  color: #000000 !important;
  font-weight: 600 !important;
  font-size: 16px !important;
}

/* MAKE ICONS 2X LARGER AND MUCH BRIGHTER */
.navbar-stable .nav-icon,
.navbar-stable .nav-icon--image,
.navbar-stable .nav-icon--fallback,
nav .nav-icon,
nav .nav-icon--image {
  width: 32px !important;      /* 2x larger: 16px -> 32px */
  height: 32px !important;     /* 2x larger: 16px -> 32px */
  margin-right: 1rem !important;
  opacity: 1 !important;
  filter: brightness(1.8) contrast(1.5) saturate(1.3) !important; /* Much brighter */
}

.navbar-stable .nav-link-stable,
nav .nav-link-stable {
  color: #000000 !important;
  font-weight: 700 !important;    /* Even bolder */
  font-size: 18px !important;     /* Larger text */
}

/* FORCE NAVBAR TEXT TO BE VISIBLE */
.navbar-stable .nav-link-stable,
.navbar-brand-link {
  color: #ffffff !important;  /* White text */
  font-weight: 600 !important;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5) !important; /* Shadow for contrast */
}

.navbar-stable .nav-link-stable:hover {
  color: #f8f9fa !important;  /* Light gray on hover */
}


/* Make upload text visible */
#drag-drop-upload * {
  color: #212529 !important;
  display: block !important;
}

/* Upload icon styling */
#drag-drop-upload .fas {
  font-size: 48px !important;
  color: #007bff !important;
  margin-bottom: 16px !important;
}

/* =================================================================== */
/* ANTI-FLASH FILE UPLOAD FIXES */
/* =================================================================== */

/* Prevent upload area flash/disappear */
#drag-drop-upload {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  position: relative !important;
  min-height: 200px !important;
  transition: none !important;
  backface-visibility: hidden;
  transform: translateZ(0);
  will-change: auto;
}

/* Force upload content to be stable */
#drag-drop-upload > * {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  position: relative !important;
}

/* Upload text and icons - prevent flash */
#drag-drop-upload .fas,
#drag-drop-upload i,
#drag-drop-upload p,
#drag-drop-upload h3 {
  opacity: 1 !important;
  visibility: visible !important;
  color: #007bff !important;
  transition: none !important;
}

/* Drag states - stable transitions */
#drag-drop-upload[data-dash-is-loading="true"] {
  opacity: 1 !important;
  visibility: visible !important;
}

/* =================================================================== */
/* ANTI-FLASH FILE UPLOAD FIXES */
/* =================================================================== */

/* Prevent upload area flash/disappear */
#drag-drop-upload {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  position: relative !important;
  min-height: 200px !important;
  transition: none !important;
  backface-visibility: hidden;
  transform: translateZ(0);
  will-change: auto;
}

/* Force upload content to be stable */
#drag-drop-upload > * {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  position: relative !important;
}

/* Upload text and icons - prevent flash */
#drag-drop-upload .fas,
#drag-drop-upload i,
#drag-drop-upload p,
#drag-drop-upload h3 {
  opacity: 1 !important;
  visibility: visible !important;
  color: #007bff !important;
  transition: none !important;
}

/* Drag states - stable transitions */
#drag-drop-upload[data-dash-is-loading="true"] {
  opacity: 1 !important;
  visibility: visible !important;
}

/* =================================================================== */
/* CSS VARIABLE FALLBACKS - PREVENT FLASH ON MISSING VARS */
/* =================================================================== */

:root {
  --color-accent: #007bff;
  --color-accent-hover: #0056b3;
  --color-accent-subtle: #e9ecef;
  --surface-tertiary: #f8f9fa;
  --surface-secondary: #ffffff;
  --text-secondary: #6c757d;
  --radius-lg: 8px;
  --space-10: 40px;
  --space-8: 32px;
  --space-5: 20px;
  --space-4: 16px;
  --space-3: 12px;
  --duration-normal: 0.3s;
  --ease-out: ease-out;
}

/* Force stability on all page containers */
.main-content,
.page-container,
[data-dash-app] {
  opacity: 1 !important;
  visibility: visible !important;
  position: relative !important;
}

/* =================================================================== */
/* DASH UPLOAD COMPONENT ANTI-FLASH FIXES */
/* =================================================================== */

/* Prevent Dash Upload loading flash */
[data-dash-is-loading="true"] {
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* Dash Upload component stability */
#drag-drop-upload {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  position: relative !important;
  min-height: 200px !important;
  transition: none !important;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Dash Upload children stability */
#drag-drop-upload > div,
#drag-drop-upload .fas,
#drag-drop-upload h5,
#drag-drop-upload p {
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  transition: none !important;
}

/* Override Dash loading indicators */
._dash-loading,
._dash-loading::after,
._dash-loading::before {
  display: none !important;
}

/* Force upload area to stay visible during all states */
#drag-drop-upload[style*="display: none"] {
  display: block !important;
}

#drag-drop-upload[style*="visibility: hidden"] {
  visibility: visible !important;
}

#drag-drop-upload[style*="opacity: 0"] {
  opacity: 1 !important;
}

/* =================================================================== */
/* UPLOAD FLASH FIX - TRANSITION DELAYS */
/* =================================================================== */

/* Delay updates to prevent simultaneous re-renders */
#preview-area {
  transition: opacity 0.1s ease-in-out;
  opacity: 1 !important;
}

#upload-progress {
  transition: all 0.05s ease-in-out 0.1s; /* Delay progress updates */
}

#upload-status {
  transition: opacity 0.05s ease-in-out 0.15s; /* Further delay status */
}

/* Prevent all elements from updating at exactly the same time */
#drag-drop-upload * {
  transition-delay: 0.01s;
}

/* =================================================================== */
/* UPLOAD FLASH FIX - TRANSITION DELAYS */
/* =================================================================== */

/* Delay updates to prevent simultaneous re-renders */
#preview-area {
  transition: opacity 0.1s ease-in-out;
  opacity: 1 !important;
}

#upload-progress {
  transition: all 0.05s ease-in-out 0.1s; /* Delay progress updates */
}

#upload-status {
  transition: opacity 0.05s ease-in-out 0.15s; /* Further delay status */
}

/* Prevent all elements from updating at exactly the same time */
#drag-drop-upload * {
  transition-delay: 0.01s;
}
